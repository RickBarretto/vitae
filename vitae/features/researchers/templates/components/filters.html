<div class="bg-white/90 backdrop-blur rounded-2xl shadow-md p-6 sticky top-6 space-y-6">
  <div>
    <h2 class="text-xl font-semibold mb-4">Pesquisar</h2>
    <form method="get" action="/search" id="filters-form">
      <input type="text" name="query" value="{{ query or '' }}" placeholder="Pesquisar por nome ou ID..."
        class="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400"
      >
      <input type="hidden" name="sort" id="hidden-sort-input" value="{{ order or '' }}">
      <div class="space-y-4 mt-6">
        <div>
          <h3 class="text-sm font-semibold text-gray-700 mb-2">País</h3>
          <select name="country" class="w-full px-3 py-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400">
            <option value="">Todos os países</option>
            {% for country in filters.countries %}
            <option value="{{ country }}" {% if choosen_filters.country == country %}selected{% endif %}>{{ country | title }}</option>
            {% endfor %}
          </select>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-700 mb-2">Estado</h3>
          <select name="state" class="w-full px-3 py-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400">
            <option value="">Todos os estados</option>
            {% for state in filters.states %}
            <option value="{{ state }}" {% if choosen_filters.state == state %}selected{% endif %}>{{ state | upper }}</option>
            {% endfor %}
          </select>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-700 mb-2">Formações iniciadas</h3>
          <select name="started" class="w-full px-3 py-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400">
            <option value="">Todas as formações</option>
            {% for title in filters.titles %}
            <option value="{{ title }}" {% if choosen_filters.started == title %}selected{% endif %}>{{ title | title }}</option>
            {% endfor %}
          </select>
          <div class="flex items-center mt-2">
            <input type="checkbox" id="has_finished" name="has_finished" value="true" class="mr-2" {% if choosen_filters.has_finished %}checked{% endif %}>
            <label for="has_finished" class="text-sm text-gray-700">Apenas concluídas</label>
          </div>
        </div>
        <div>
          <h3 class="text-sm font-semibold text-gray-700 mb-2">Área de atuação</h3>
          <select name="expertise" class="w-full px-3 py-2 border-2 border-gray-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400">
            <option value="">Todas as áreas</option>
            {% for expertise in filters.expertises %}
            <option value="{{ expertise }}" {% if choosen_filters.expertise == expertise %}selected{% endif %}>{{ expertise | title }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
      <button type="submit"
        class="w-full mt-6 text-gray-600 border-2 border-gray-300 rounded-md py-2 hover:border-indigo-400 hover:text-indigo-500 transition"
      >
        Buscar
      </button>
      <script>
        // Keep the hidden sort input in sync with the sort dropdown
        document.addEventListener('DOMContentLoaded', function() {
          var sortSelect = document.getElementById('sort-select');
          var hiddenSort = document.getElementById('hidden-sort-input');
          if (sortSelect && hiddenSort) {
            sortSelect.addEventListener('change', function() {
              hiddenSort.value = sortSelect.value;
            });
          }
        });
      </script>
    </form>
    <button
      onclick="window.location.href='/'"
      class="w-full text-gray-600 border-2 border-gray-300 rounded-md py-2 mt-2 hover:border-indigo-400 hover:text-indigo-500 transition"
    >
      Limpar Todos os Filtros
    </button>
  </div>
</div>
